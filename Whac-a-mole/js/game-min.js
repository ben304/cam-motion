void function(e){function t(e){if(e>=LEVEL[3].SCORE)return LEVEL[3];for(var t=0;t<4;t++)if(e<=LEVEL[t].SCORE)return LEVEL[t]}function n(e){var t=e.CHANCE,n=t[Math.random()*t.length|0],r=n*5,i=r+5;return MONSTER[(Math.random()*(i-r)|0)+r]}function u(){this.phase=$("#stage>div");this.evts=o;this._reset();this._displayCurrentPhase()}var r=0,i=0,s=function(){},o={start:s,process:s,over:s};$.extend(u.prototype,{_displayCurrentPhase:function(){$(this.phase[i]).show()},_start:function(){var e=0,t=GAME_TIME/1e3,n=this,i=setInterval(function(){if(e>=t){clearInterval(i);i=null;n.evts.over(r);return}n.evts.process(e++)},1e3);this.evts.start(this._getHoles())},_reset:function(){r=0,i=0;$("#holds .monster").each(function(e,t){t.className="monster"})},_getHoles:function(){var e=$("#holes li"),t={width:120,height:120,holes:[]};e.each(function(e,n){var r=$(n).offset();t.holes.push({index:e,x:parseInt($(n).css("left")),y:parseInt($(n).css("top"))})});return t},on:function(e,t){this.evts[e]=t;return this},nextPhase:function(e){$(this.phase[i]).hide();i=Math.min(++i,this.phase.length-1);this._displayCurrentPhase();$(this.phase[i]).hasClass("gaming")&&this._start();e&&e();return this},restart:function(){this._reset();this.nextPhase()},getMonster:function(){var e=t(r),i=n(e);return{level:e,monster:i}},addScore:function(e){return r+=e}});e.Game=u}(window);